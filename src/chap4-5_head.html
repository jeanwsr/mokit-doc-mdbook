<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Tutorial Demo</title>
  </head>
  <body>
    <div id="mountNode"></div>
    <!-- <script src="https://gw.alipayobjects.com/os/antv/pkg/_antv.g6-3.7.1/dist/g6.min.js"></script> -->
    <!-- 4.x and later versions -->
    <script src="https://gw.alipayobjects.com/os/lib/antv/g6/4.8.7/dist/g6.min.js"></script>
    <script>
      //const initData = ;
      G6.registerNode('util', 
      {
        getCustomConfig() {
          return {
            size: [60,30],
          style: {
            cursor: 'pointer',
          },
        };
        
        },
        //update(cfg, node) {},
      },
      'diamond',
      );
      G6.registerNode('program', 
      { 
        getCustomConfig() {
          return {
            size: [100,50],
          };
        },
      },
      'ellipse',
      );
      const graph = new G6.Graph({
        container: 'mountNode',
        width: 1000,
        height: 600,
        //fitView: true,
        //fitViewPadding: [20, 40, 50, 20],
        //defaultNode: {
        //  
        //  style: {
        //    cursor: 'pointer',
        //  }
        //},
        defaultEdge: {
          label: '',
          type: 'quadratic',
          style: {
            lineWidth: 5,
            endArrow: true,
            //endArrow: {
            //  path: G6.Arrow.vee(5,10,10),
            //  d: 10,
            //},
          }
        }
      });

      const main = async() => {
        const theresponse = await fetch(
          './data.json',
        );
        const initData = await theresponse.json();
      
        graph.data(initData); 
        graph.on('node:click', (ev) => {
          const node = ev.item.getModel().id;
          var sel = '[id$="' + node + '"]';
          var id = window.parent.document.querySelector(sel).id;
          console.log(node);
          console.log(id);
          window.parent.open(window.parent.location.href + '#' + id);
        });
        graph.render(); 
      };
      main();
</script>
  </body>
</html>